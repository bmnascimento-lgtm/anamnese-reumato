<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Anamnese Reumatologia - HDA Cronol√≥gica</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f0f5f9;
            padding: 20px;
            color: #1e3c5c;
        }
        .container {
            max-width: 1600px;
            margin: 0 auto;
        }
        h1 {
            color: #0a2942;
            margin-bottom: 20px;
            font-size: 2rem;
            border-bottom: 3px solid #4a90e2;
            padding-bottom: 10px;
        }
        h2 {
            background: #1e4a76;
            color: white;
            padding: 10px 15px;
            border-radius: 8px 8px 0 0;
            font-size: 1.2rem;
            margin-top: 20px;
            margin-bottom: 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        h2 button {
            margin-left: auto;
            background: white;
            border: none;
            border-radius: 4px;
            padding: 4px 12px;
            font-size: 0.9rem;
            cursor: pointer;
            color: #1e4a76;
            font-weight: bold;
        }
        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 12px;
            background: #d9e6f2;
            padding: 15px;
            border-radius: 0 0 8px 8px;
            margin-bottom: 10px;
        }
        .item-card {
            background: white;
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.1);
            transition: 0.2s;
            border-left: 5px solid #4a90e2;
        }
        .item-card:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        .sintoma-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 8px;
        }
        .sintoma-header input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
            accent-color: #1e4a76;
        }
        .sintoma-header label {
            font-weight: 600;
            cursor: pointer;
            flex-grow: 1;
            color: #0a2942;
            font-size: 0.95rem;
        }
        .tempo-sintoma {
            margin-left: 32px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
            color: #1e4a76;
            padding: 5px 0;
        }
        .tempo-sintoma input {
            border: 1px solid #b0c8da;
            border-radius: 4px;
            padding: 4px 8px;
            width: 120px;
            font-size: 0.9rem;
        }
        .tempo-sintoma select {
            border: 1px solid #b0c8da;
            border-radius: 4px;
            padding: 4px;
            background: white;
        }
        .med-group {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            align-items: center;
            width: 100%;
        }
        .double-col {
            grid-column: span 2;
        }
        .footer-actions {
            margin-top: 30px;
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }
        .btn {
            background: #1e4a76;
            color: white;
            border: none;
            padding: 12px 28px;
            border-radius: 50px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: 0.2s;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        .btn:hover {
            background: #0a2942;
            transform: scale(1.02);
        }
        .btn.secondary {
            background: #6c757d;
        }
        .btn.success {
            background: #28a745;
        }
        .resumo-bar {
            background: white;
            border-radius: 50px;
            padding: 12px 20px;
            margin: 20px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
        }
        .badge {
            background: #1e4a76;
            color: white;
            border-radius: 20px;
            padding: 4px 16px;
            font-weight: 600;
        }
        .obs-field {
            background: white;
            border-radius: 8px;
            padding: 15px;
            border: 1px solid #b0c8da;
            margin-bottom: 15px;
        }
        textarea {
            width: 100%;
            border: 1px solid #b0c8da;
            border-radius: 8px;
            padding: 12px;
            font-family: inherit;
            font-size: 0.95rem;
            resize: vertical;
        }
        .paciente-info {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            background: white;
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 20px;
            align-items: flex-end;
        }
        .info-field {
            display: flex;
            flex-direction: column;
            gap: 5px;
            min-width: 100px;
        }
        .info-field label {
            font-weight: 600;
            color: #1e4a76;
            font-size: 0.9rem;
        }
        .info-field input, .info-field select {
            padding: 6px;
            border: 1px solid #b0c8da;
            border-radius: 6px;
            font-size: 0.95rem;
        }
        .imc-result {
            background: #e8f4fd;
            padding: 6px 12px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9rem;
        }
        .hd-box {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            border-left: 8px solid #4a90e2;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .hd-title {
            font-size: 1.2rem;
            font-weight: bold;
            color: #1e4a76;
            margin-bottom: 15px;
        }
        .sugestao-item {
            background: #f8f9fa;
            padding: 12px;
            border-radius: 8px;
            margin: 5px 0;
            border-left: 3px solid #ffc107;
        }
        .conduta-gerada {
            background: #e8f4fd;
            padding: 15px;
            border-radius: 8px;
            margin-top: 10px;
            white-space: pre-wrap;
            border: 1px solid #4a90e2;
            font-size: 0.95rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ü©∫ Anamnese Reumatologia - HDA Cronol√≥gica</h1>

        <!-- Dados do Paciente -->
        <div class="paciente-info">
            <div class="info-field">
                <label>Sexo:</label>
                <select id="sexo" onchange="atualizarVisibilidadeFisiologico()">
                    <option value="">Selecione</option>
                    <option value="F">Feminino</option>
                    <option value="M">Masculino</option>
                </select>
            </div>
            <div class="info-field">
                <label>Ra√ßa/Cor:</label>
                <select id="raca">
                    <option value="">Selecione</option>
                    <option>Branca</option>
                    <option>Preta</option>
                    <option>Parda</option>
                    <option>Amarela</option>
                    <option>Ind√≠gena</option>
                </select>
            </div>
            <div class="info-field">
                <label>Idade (anos):</label>
                <input type="number" id="idade" min="0" max="120" step="1">
            </div>
            <div class="info-field">
                <label>Peso (kg):</label>
                <input type="number" id="peso" min="0" max="300" step="0.1" oninput="calcularIMC()">
            </div>
            <div class="info-field">
                <label>Altura (cm):</label>
                <input type="number" id="altura" min="0" max="250" step="1" oninput="calcularIMC()">
            </div>
            <div class="info-field">
                <label>IMC:</label>
                <div class="imc-result" id="imc">-</div>
            </div>
        </div>

        <!-- Resumo -->
        <div class="resumo-bar">
            <span><span class="badge" id="totalMarcados">0</span> sintomas marcados</span>
            <span>üìå <span id="resumoQueixa" style="font-weight:600;">‚Äî</span></span>
        </div>

        <!-- Queixa Principal -->
        <div class="obs-field">
            <label style="font-weight:700;">üó£Ô∏è Queixa Principal:</label>
            <textarea id="queixaPrincipal" rows="2" placeholder="Ex: Dor nas juntas h√° 3 meses..." oninput="atualizarResumo()"></textarea>
        </div>

        <!-- SINAIS E SINTOMAS -->
        <h2>üîç SINAIS E SINTOMAS <button onclick="toggleAll('sinais', true)">Marcar todos</button><button onclick="toggleAll('sinais', false)">Limpar</button></h2>
        <div class="card-grid" id="sinais"></div>

        <!-- MEDICAMENTOS -->
        <h2>üíä MEDICAMENTOS EM USO</h2>
        <div class="card-grid" id="medicamentos"></div>

        <!-- COMORBIDADES -->
        <h2>üìã COMORBIDADES</h2>
        <div class="card-grid" id="comorbidades"></div>

        <!-- EXAME F√çSICO -->
        <h2>ü©ª EXAME F√çSICO</h2>
        <div class="card-grid">
            <div class="item-card double-col">
                <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                    <span>PA: <input type="text" placeholder="120x80" id="pa" style="width:100px;"></span>
                    <span>FC: <input type="text" placeholder="bpm" id="fc" style="width:70px;"></span>
                    <span>FR: <input type="text" placeholder="irpm" id="fr" style="width:70px;"></span>
                    <span>Temp: <input type="text" placeholder="¬∞C" id="temp" style="width:70px;"></span>
                </div>
            </div>
            <div class="item-card double-col">
                <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                    <span>AC: <input type="text" placeholder="RR 2T" id="ac" style="width:120px;"></span>
                    <span>AP: <input type="text" placeholder="MV+ sem RA" id="ap" style="width:150px;"></span>
                </div>
            </div>
            <div class="item-card double-col">
                <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                    <span>Abdome: <input type="text" placeholder="..." id="abdome" style="width:150px;"></span>
                    <span>Extrem: <input type="text" placeholder="Sem edema" id="extrem" style="width:150px;"></span>
                </div>
            </div>
        </div>

        <!-- Hip√≥tese e Conduta -->
        <div class="hd-box">
            <div class="hd-title">ü§ñ Hip√≥tese Diagn√≥stica (baseada nos sintomas)</div>
            <div id="sugestaoHD" class="sugestao-item">Selecione os sintomas para ver sugest√µes...</div>
            
            <button class="btn success" onclick="gerarCondutaAutomatica()" style="margin:15px 0;">‚ö° Gerar Conduta Autom√°tica</button>
            
            <div class="hd-title">üìã Conduta</div>
            <textarea id="conduta" rows="6" placeholder="Conduta gerada automaticamente..."></textarea>
        </div>

        <!-- Antecedentes Feminino -->
        <div id="antecedentesFeminino" style="display: none;">
            <h2>üß¨ ANTECEDENTES (Feminino)</h2>
            <div class="card-grid">
                <div class="item-card"><input type="checkbox" id="menopausa"><label>Menopausa</label></div>
                <div class="item-card"><input type="checkbox" id="reposHorm"><label>Reposi√ß√£o Hormonal</label></div>
                <div class="item-card">
                    <label>Menstrua√ß√£o:</label>
                    <select id="menstruacao">
                        <option value="">--</option>
                        <option>Regular</option>
                        <option>Irregular</option>
                    </select>
                </div>
                <div class="item-card">
                    <label>G:</label><input type="number" id="g" style="width:50px;">
                    <label>P:</label><input type="number" id="p" style="width:50px;">
                    <label>A:</label><input type="number" id="a" style="width:50px;">
                </div>
            </div>
        </div>

        <!-- Bot√µes -->
        <div class="footer-actions">
            <button class="btn" onclick="gerarResumoCompleto()">üìã Gerar HDA + Conduta</button>
            <button class="btn secondary" onclick="limparTudo()">üîÑ Nova Consulta</button>
        </div>
        <div id="resumoFinal" style="margin-top:30px; background:#e9f0f9; padding:20px; border-radius:12px; display:none; white-space:pre-wrap; line-height:1.6;"></div>
    </div>

    <script>
        const sintomasLista = [
            {tecnico: "RASH MALAR", leigo: "Vermelhid√£o no rosto (asa de borboleta)"},
            {tecnico: "FOTOSSENSIBILIDADE", leigo: "Pele sens√≠vel ao sol"},
            {tecnico: "ULCERAS ORAIS", leigo: "Feridas na boca ou nariz"},
            {tecnico: "SEROSITE", leigo: "Dor no peito ao respirar"},
            {tecnico: "ANEMIA", leigo: "Cansa√ßo, palidez"},
            {tecnico: "ARTRITE PEQUENAS ARTICULA√á√ïES", leigo: "Dor e incha√ßo nas m√£os/punhos/p√©s"},
            {tecnico: "ARTRITE GRANDES ARTICULA√á√ïES", leigo: "Dor e incha√ßo nos joelhos/ombros/quadris"},
            {tecnico: "RIGIDEZ MATINAL >30 MIN", leigo: "Travamento ao acordar >30 min"},
            {tecnico: "RIGIDEZ MATINAL <30 MIN", leigo: "Travamento ao acordar <30 min"},
            {tecnico: "LINFADENOPATIA", leigo: "√çnguas"},
            {tecnico: "ALOP√âCIA DIFUSA", leigo: "Queda de cabelo generalizada"},
            {tecnico: "ALOP√âCIA AREATA", leigo: "Queda de cabelo em placas"},
            {tecnico: "HEMAT√öRIA", leigo: "Sangue na urina"},
            {tecnico: "CONVULS√ÉO", leigo: "Crises convulsivas"},
            {tecnico: "CEFAL√âIA", leigo: "Dor de cabe√ßa frequente"},
            {tecnico: "RAYNAUD", leigo: "Dedos ficam roxos/brancos no frio"},
            {tecnico: "XEROSTOMIA", leigo: "Boca seca constante"},
            {tecnico: "XEROFTALMIA", leigo: "Olhos secos"},
            {tecnico: "PARESTESIAS", leigo: "Formigamento/dorm√™ncia"},
            {tecnico: "PET√âQUIAS", leigo: "Manchas vermelhas na pele"},
            {tecnico: "PSOR√çASE", leigo: "Manchas com descama√ß√£o"},
            {tecnico: "FEBRE", leigo: "Febre sem causa aparente"},
            {tecnico: "EMAGRECIMENTO", leigo: "Perda de peso"},
            {tecnico: "LOMBALGIA INFLAMAT√ìRIA", leigo: "Dor nas costas que piora com descanso"},
            {tecnico: "LOMBALGIA MEC√ÇNICA", leigo: "Dor nas costas ao esfor√ßo"},
            {tecnico: "UVE√çTE", leigo: "Olho vermelho e doloroso"},
            {tecnico: "FRAQUEZA MUSCULAR", leigo: "Dificuldade para levantar bra√ßos/pernas"},
            {tecnico: "DISPN√âIA", leigo: "Falta de ar"},
            {tecnico: "DISFAGIA", leigo: "Dificuldade para engolir"},
            {tecnico: "TROMBOSE VENOSA", leigo: "Dor e incha√ßo na perna (trombose)"}
        ];

        const medicamentosBase = [
            { nome: "PREDNISONA", unidade: "mg/dia" },
            { nome: "DEFLAZACORT", unidade: "mg/dia" },
            { nome: "METOTREXATE", opcoes: ["VO", "SC"], unidade: "mg/sem" },
            { nome: "LEFLUNOMIDA", unidade: "mg/dia" },
            { nome: "AZATIOPRINA", unidade: "mg/dia" },
            { nome: "SULFASSALAZINA", unidade: "mg/dia" },
            { nome: "HIDROXICLOROQUINA", unidade: "mg/dia" },
            { nome: "C√ÅLCIO", unidade: "mg/dia" },
            { nome: "VITAMINA D", unidade: "UI/dia" },
            { nome: "ANTI-INFLAMAT√ìRIO", unidade: "mg/dia" },
            { nome: "AAS", unidade: "mg/dia" },
            { nome: "ANTI-HIPERTENSIVO", unidade: "mg/dia" },
            { nome: "AMITRIPTILINA", unidade: "mg/dia" },
            { nome: "DULOXETINA", unidade: "mg/dia" },
            { nome: "PREGANALINA", unidade: "mg/dia" },
            { nome: "GABAPENTINA", unidade: "mg/dia" }
        ];

        const comorbidadesLista = [
            "HAS", "DM", "Dislipidemia", "Osteoporose", "Artrose", "Gota", 
            "Fibromialgia", "Hipotireoidismo", "Ansiedade", "Depress√£o", 
            "Tabagismo", "Etilismo"
        ];

        function gerarCheckboxes() {
            let htmlSinais = '';
            sintomasLista.forEach((s, index) => {
                htmlSinais += `
                    <div class="item-card" data-index="${index}">
                        <div class="sintoma-header">
                            <input type="checkbox" class="sinal" data-tecnico="${s.tecnico}" onchange="toggleTempoSintoma(this)">
                            <label title="${s.tecnico}">${s.leigo}</label>
                        </div>
                        <div class="tempo-sintoma" style="display: none;">
                            <span>H√°:</span>
                            <input type="number" class="tempo-valor" min="0" step="1" placeholder="n√∫mero" style="width:70px;">
                            <select class="tempo-unidade">
                                <option value="dias">dias</option>
                                <option value="semanas">semanas</option>
                                <option value="meses">meses</option>
                                <option value="anos">anos</option>
                            </select>
                        </div>
                    </div>
                `;
            });
            document.getElementById('sinais').innerHTML = htmlSinais;

            let htmlMed = '';
            medicamentosBase.forEach(m => {
                htmlMed += `<div class="item-card">`;
                htmlMed += `<input type="checkbox" class="med-check">`;
                htmlMed += `<label>${m.nome}</label>`;
                htmlMed += `<div class="med-group">`;
                if (m.opcoes) {
                    htmlMed += `<select class="med-via"><option>${m.opcoes.join('</option><option>')}</option></select>`;
                }
                htmlMed += `<input type="text" class="med-dose" placeholder="dose (${m.unidade})" style="width:100px;">`;
                htmlMed += `</div></div>`;
            });
            document.getElementById('medicamentos').innerHTML = htmlMed;

            let htmlComorb = '';
            comorbidadesLista.forEach(c => {
                htmlComorb += `<div class="item-card"><input type="checkbox"><label>${c}</label></div>`;
            });
            document.getElementById('comorbidades').innerHTML = htmlComorb;
        }

        function toggleTempoSintoma(checkbox) {
            const itemCard = checkbox.closest('.item-card');
            const tempoDiv = itemCard.querySelector('.tempo-sintoma');
            tempoDiv.style.display = checkbox.checked ? 'flex' : 'none';
            if (!checkbox.checked) {
                tempoDiv.querySelector('.tempo-valor').value = '';
            }
            atualizarResumo();
            atualizarHD();
        }

        function calcularIMC() {
            const peso = parseFloat(document.getElementById('peso').value);
            const altura = parseFloat(document.getElementById('altura').value) / 100;
            if (peso && altura) {
                const imc = peso / (altura * altura);
                document.getElementById('imc').innerText = imc.toFixed(2);
            } else {
                document.getElementById('imc').innerText = '-';
            }
        }

        function atualizarVisibilidadeFisiologico() {
            const sexo = document.getElementById('sexo').value;
            document.getElementById('antecedentesFeminino').style.display = sexo === 'F' ? 'block' : 'none';
        }

        function atualizarHD() {
            const sintomasSelecionados = [];
            document.querySelectorAll('#sinais input.sinal:checked').forEach(cb => {
                sintomasSelecionados.push(cb.getAttribute('data-tecnico'));
            });

            let sugestoes = [];
            
            if (sintomasSelecionados.includes('ARTRITE PEQUENAS ARTICULA√á√ïES') && 
                sintomasSelecionados.includes('RIGIDEZ MATINAL >30 MIN')) {
                sugestoes.push("üî¥ Artrite Reumatoide (prov√°vel)");
            }
            
            let pontosLES = 0;
            if (sintomasSelecionados.includes('RASH MALAR')) pontosLES += 2;
            if (sintomasSelecionados.includes('FOTOSSENSIBILIDADE')) pontosLES += 1;
            if (sintomasSelecionados.includes('ULCERAS ORAIS')) pontosLES += 1;
            if (sintomasSelecionados.includes('ARTRITE PEQUENAS ARTICULA√á√ïES')) pontosLES += 1;
            if (sintomasSelecionados.includes('SEROSITE')) pontosLES += 2;
            
            if (pontosLES >= 4) {
                sugestoes.push("üü£ L√∫pus Eritematoso Sist√™mico (prov√°vel)");
            }
            
            if (sintomasSelecionados.includes('LOMBALGIA INFLAMAT√ìRIA')) {
                sugestoes.push("üîµ Espondiloartrite (poss√≠vel)");
            }
            
            if (sintomasSelecionados.includes('XEROSTOMIA') && sintomasSelecionados.includes('XEROFTALMIA')) {
                sugestoes.push("üü¢ S√≠ndrome de Sj√∂gren (poss√≠vel)");
            }

            document.getElementById('sugestaoHD').innerHTML = sugestoes.length > 0 ? 
                sugestoes.map(s => `‚Ä¢ ${s}`).join('<br>') : 
                '‚Ä¢ Nenhuma hip√≥tese espec√≠fica identificada.';
        }

        function gerarCondutaAutomatica() {
            const hipoteseDiv = document.getElementById('sugestaoHD').innerText;
            let conduta = [];
            
            conduta.push("üìã EXAMES A SOLICITAR:");
            conduta.push("‚Ä¢ Hemograma completo, VHS, PCR");
            conduta.push("‚Ä¢ FAN, FR");
            conduta.push("‚Ä¢ Fun√ß√£o renal e hep√°tica");
            
            if (hipoteseDiv.includes('Artrite Reumatoide')) {
                conduta.push("‚Ä¢ Anti-CCP, radiografias de m√£os e p√©s");
                conduta.push("\nüíä TRATAMENTO:");
                conduta.push("‚Ä¢ Metotrexate 7.5-15mg/sem + √°cido f√≥lico");
                conduta.push("‚Ä¢ Prednisona 5-10mg/dia se necess√°rio");
            } else if (hipoteseDiv.includes('L√∫pus')) {
                conduta.push("‚Ä¢ Anti-DNA, C3, C4, protein√∫ria 24h");
                conduta.push("\nüíä TRATAMENTO:");
                conduta.push("‚Ä¢ Hidroxicloroquina 400mg/dia");
                conduta.push("‚Ä¢ Prednisona conforme atividade");
            } else {
                conduta.push("\nüíä TRATAMENTO:");
                conduta.push("‚Ä¢ Tratamento sintom√°tico conforme hip√≥tese");
            }
            
            conduta.push("\nüìå RETORNO:");
            conduta.push("‚Ä¢ Retornar em 4 semanas com exames");
            
            document.getElementById('conduta').value = conduta.join('\n');
        }

        function gerarResumoCompleto() {
            let hda = [];
            
            // Dados do paciente
            const sexo = document.getElementById('sexo').value;
            const idade = document.getElementById('idade').value;
            const raca = document.getElementById('raca').value;
            
            let pacienteDesc = "Paciente";
            if (sexo === 'F') pacienteDesc += " feminino";
            else if (sexo === 'M') pacienteDesc += " masculino";
            if (raca) pacienteDesc += `, ${raca.toLowerCase()}`;
            if (idade) pacienteDesc += `, ${idade} anos`;
            
            hda.push(pacienteDesc + ", " + (document.getElementById('queixaPrincipal').value || "sem queixa principal registrada") + "\n");
            
            // Coletar sintomas com tempo
            let sintomasComTempo = [];
            document.querySelectorAll('#sinais .item-card').forEach(card => {
                const checkbox = card.querySelector('.sinal');
                if (checkbox && checkbox.checked) {
                    const sintoma = card.querySelector('label').innerText;
                    const tempoValor = card.querySelector('.tempo-valor')?.value;
                    const tempoUnidade = card.querySelector('.tempo-unidade')?.value;
                    
                    if (tempoValor && tempoUnidade) {
                        sintomasComTempo.push({
                            sintoma: sintoma,
                            tempo: parseInt(tempoValor),
                            unidade: tempoUnidade
                        });
                    }
                }
            });
            
            // Ordenar por tempo (do mais antigo para o mais recente)
            const tempoEmDias = (item) => {
                const dias = {
                    'dias': 1,
                    'semanas': 7,
                    'meses': 30,
                    'anos': 365
                };
                return item.tempo * (dias[item.unidade] || 1);
            };
            
            sintomasComTempo.sort((a, b) => tempoEmDias(a) - tempoEmDias(b));
            
            if (sintomasComTempo.length > 0) {
                hda.push("\nüìÖ HIST√ìRIA CRONOL√ìGICA DOS SINTOMAS:");
                sintomasComTempo.forEach(item => {
                    hda.push(`‚Ä¢ ${item.sintoma} - h√° ${item.tempo} ${item.unidade}`);
                });
                hda.push("");
            }
            
            // Medicamentos
            const medicamentos = [];
            document.querySelectorAll('#medicamentos .item-card').forEach(card => {
                const cb = card.querySelector('input[type="checkbox"]');
                if (cb && cb.checked) {
                    let nome = card.querySelector('label')?.innerText || '';
                    const dose = card.querySelector('.med-dose')?.value;
                    const via = card.querySelector('select')?.value;
                    let txt = nome;
                    if (via) txt += ` (${via})`;
                    if (dose) txt += ` ${dose}`;
                    medicamentos.push(txt);
                }
            });
            
            if (medicamentos.length > 0) {
                hda.push("\nüíä MEDICAMENTOS EM USO:");
                hda.push(medicamentos.join('; '));
            }
            
            // Comorbidades
            const comorbidades = [];
            document.querySelectorAll('#comorbidades input:checked').forEach(cb => {
                comorbidades.push(cb.parentElement.querySelector('label').innerText);
            });
            
            if (comorbidades.length > 0) {
                hda.push("\nüìã COMORBIDADES:");
                hda.push(comorbidades.join(', '));
            }
            
            // Exame f√≠sico
            hda.push("\nü©ª EXAME F√çSICO:");
            hda.push(`PA: ${document.getElementById('pa').value || 'N/I'}, FC: ${document.getElementById('fc').value || 'N/I'}, FR: ${document.getElementById('fr').value || 'N/I'}`);
            hda.push(`AC: ${document.getElementById('ac').value || 'N/I'}`);
            hda.push(`AP: ${document.getElementById('ap').value || 'N/I'}`);
            hda.push(`Extremidades: ${document.getElementById('extrem').value || 'N/I'}`);
            
            // Hip√≥tese
            hda.push("\nüîç HIP√ìTESE DIAGN√ìSTICA:");
            hda.push(document.getElementById('sugestaoHD').innerText.replace(/[‚Ä¢üî¥üü£üîµüü¢]/g, '').trim() || 'A definir');
            
            // Conduta
            hda.push("\nüìã CONDUTA:");
            hda.push(document.getElementById('conduta').value || 'A definir');
            
            const resumoDiv = document.getElementById('resumoFinal');
            resumoDiv.style.display = 'block';
            resumoDiv.innerText = hda.join('\n');
        }

        function toggleAll(sectionId, check) {
            const container = document.getElementById(sectionId);
            container.querySelectorAll('input[type="checkbox"]').forEach(cb => {
                cb.checked = check;
                if (sectionId === 'sinais') {
                    const card = cb.closest('.item-card');
                    const tempoDiv = card?.querySelector('.tempo-sintoma');
                    if (tempoDiv) tempoDiv.style.display = check ? 'flex' : 'none';
                }
            });
            atualizarResumo();
            atualizarHD();
        }

        function atualizarResumo() {
            const total = document.querySelectorAll('#sinais input[type="checkbox"]:checked').length;
            document.getElementById('totalMarcados').innerText = total;
            const queixa = document.getElementById('queixaPrincipal').value.trim();
            document.getElementById('resumoQueixa').innerText = queixa.substring(0, 30) + (queixa.length > 30 ? '...' : '') || '‚Äî';
        }

        function limparTudo() {
            document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
            document.querySelectorAll('.tempo-sintoma').forEach(div => div.style.display = 'none');
            document.querySelectorAll('input[type="text"], input[type="number"], select, textarea').forEach(field => field.value = '');
            document.getElementById('sexo').value = '';
            document.getElementById('raca').value = '';
            document.getElementById('imc').innerText = '-';
            atualizarResumo();
            atualizarHD();
            document.getElementById('resumoFinal').style.display = 'none';
        }

        window.onload = () => {
            gerarCheckboxes();
            document.addEventListener('change', () => {
                atualizarResumo();
                atualizarHD();
            });
        };
    </script>
</body>
</html>
