<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Sistema Reumatologia</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
body {
    font-family: Arial;
    background: #e9edf2;
    margin: 20px;
}

.container {
    background: white;
    padding: 20px;
    border-radius: 10px;
    margin-bottom: 15px;
}

h2 {
    border-bottom: 1px solid #ccc;
    padding-bottom: 5px;
}

button {
    padding: 10px 15px;
    margin-top: 10px;
    margin-right: 10px;
    cursor: pointer;
}

textarea {
    width: 100%;
    height: 400px;
    margin-top: 20px;
}
</style>
</head>
<body>

<h1>Sistema Clínico Reumatologia</h1>

<div class="container">
<h2>Articulações Acometidas</h2>
<input type="number" id="num_pequenas" placeholder="Nº pequenas articulações">
<input type="number" id="num_grandes" placeholder="Nº grandes articulações">
</div>

<div class="container">
<h2>Padrão Clínico</h2>
<input type="checkbox" id="inflamatoria"> Dor inflamatória
<input type="checkbox" id="rigidez"> Rigidez >30min
<input type="checkbox" id="simetrico"> Simétrico
<input type="checkbox" id="lombalgia_inflamatoria"> Lombalgia inflamatória
<input type="checkbox" id="entesite"> Entesite
<input type="checkbox" id="uveite"> Uveíte
</div>

<div class="container">
<h2>Laboratório</h2>
<input type="checkbox" id="fr"> Fator Reumatoide +
<input type="checkbox" id="anti_ccp"> Anti-CCP +
<input type="checkbox" id="vhs_alta"> VHS/PCR elevados
<br><br>
<select id="fan_resultado">
<option value="">FAN</option>
<option value="homogeneo">Homogêneo</option>
<option value="pontilhado_fino">Pontilhado fino</option>
<option value="pontilhado_grosso">Pontilhado grosso</option>
<option value="centromerico">Centromérico</option>
<option value="nucleolar">Nucleolar</option>
</select>
</div>

<div class="container">
<h2>DAS28 (simplificado)</h2>
<input type="number" id="art_dolorosas" placeholder="Articulações dolorosas (0-28)">
<input type="number" id="art_edemaciadas" placeholder="Articulações edemaciadas (0-28)">
<input type="number" id="vhs_valor" placeholder="VHS">
<input type="number" id="vas" placeholder="VAS dor (0-100)">
</div>

<button onclick="gerar()">Gerar Relatório</button>
<button onclick="exportarPDF()">Exportar PDF</button>

<textarea id="resultado"></textarea>

<script>

function gerar(){

let texto = "RELATÓRIO REUMATOLÓGICO\n\n";

// ================= AR SCORE =================
let scoreAR = 0;
let pequenas = parseInt(num_pequenas.value) || 0;
let grandes = parseInt(num_grandes.value) || 0;

if(pequenas >= 4) scoreAR += 3;
else if(pequenas >=1) scoreAR += 2;
else if(grandes >=1) scoreAR += 1;

if(fr.checked || anti_ccp.checked) scoreAR += 3;
if(vhs_alta.checked) scoreAR += 1;
if(rigidez.checked) scoreAR += 1;

texto += "Pontuação ACR/EULAR simplificada AR: " + scoreAR + "\n";

if(scoreAR >= 6){
    texto += "→ Critérios compatíveis com Artrite Reumatoide.\n\n";
}

// ================= ESPONDILOARTRITE =================
if(lombalgia_inflamatoria.checked && (entesite.checked || uveite.checked)){
    texto += "→ Critérios sugestivos de Espondiloartrite.\n\n";
}

// ================= FAN =================
if(fan_resultado.value != ""){
    texto += "Interpretação FAN: ";
    if(fan_resultado.value == "homogeneo")
        texto += "Padrão associado a LES ou doença autoimune sistêmica.\n";
    if(fan_resultado.value == "pontilhado_fino")
        texto += "Pode estar associado a LES ou síndrome de Sjögren.\n";
    if(fan_resultado.value == "pontilhado_grosso")
        texto += "Associado a doenças do tecido conectivo.\n";
    if(fan_resultado.value == "centromerico")
        texto += "Sugestivo de Esclerose Sistêmica limitada.\n";
    if(fan_resultado.value == "nucleolar")
        texto += "Sugestivo de Esclerose Sistêmica difusa.\n";
}

// ================= DAS28 =================
let dolorosas = parseInt(art_dolorosas.value) || 0;
let edemaciadas = parseInt(art_edemaciadas.value) || 0;
let vhs = parseInt(vhs_valor.value) || 0;
let vas_dor = parseInt(vas.value) || 0;

if(dolorosas || edemaciadas || vhs || vas_dor){
    let das = (0.56 * Math.sqrt(dolorosas)) + 
              (0.28 * Math.sqrt(edemaciadas)) + 
              (0.70 * Math.log(vhs)) + 
              (0.014 * vas_dor);

    texto += "\nDAS28 aproximado: " + das.toFixed(2) + "\n";

    if(das < 2.6) texto += "Remissão.\n";
    else if(das < 3.2) texto += "Baixa atividade.\n";
    else if(das < 5.1) texto += "Atividade moderada.\n";
    else texto += "Alta atividade.\n";
}

document.getElementById("resultado").value = texto;
}


// PDF
function exportarPDF(){
const { jsPDF } = window.jspdf;
let doc = new jsPDF();
let texto = document.getElementById("resultado").value;
doc.text(texto, 10, 10);
doc.save("relatorio_reumatologia.pdf");
}

</script>

</body>
</html>
